<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PIX Dinâmico - C6 Bank</title>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<style>
body {
    font-family: Arial;
    background: #f2f2f2;
    text-align: center;
    padding: 30px;
}
input {
    font-size: 20px;
    padding: 10px;
    width: 200px;
}
button {
    font-size: 20px;
    padding: 10px 20px;
    margin-top: 10px;
    cursor: pointer;
}
#qrcode {
    margin-top: 20px;
}
#pix {
    margin-top: 20px;
    background: #fff;
    padding: 10px;
    word-break: break-all;
}
</style>
</head>
<body>

<h2>PIX - C6 Bank</h2>
<p>Digite o valor:</p>
<input id="valor" type="number" step="0.01" placeholder="Ex: 25.50">
<br><br>
<button onclick="gerar()">Gerar PIX</button>

<div id="qrcode"></div>
<div id="pix"></div>

<script>
const pixBase = "00020101021126330014br.gov.bcb.pix0111377793998695204000053039865802BR5925ZAYAN DOUX DE SOUZA OLIVE6009SAO PAULO622905251KHPGDNVGBS01VTEG5JDK7R2S6304";

function gerar(){
    let v = document.getElementById("valor").value;
    if(!v || v <= 0){
        alert("Digite um valor válido");
        return;
    }

    let valor = parseFloat(v).toFixed(2);
    let tamanho = valor.length.toString().padStart(2, "0");

    let payload = pixBase.replace("5802BR", "54"+tamanho+valor+"5802BR");

    let crc = calcularCRC(payload);
    let pixFinal = payload + crc;

    document.getElementById("pix").innerText = pixFinal;

    QRCode.toCanvas(document.getElementById("qrcode"), pixFinal, {width:300});
}

function calcularCRC(str) {
    let crc = 0xFFFF;
    for (let c = 0; c < str.length; c++) {
        crc ^= str.charCodeAt(c) << 8;
        for (let i = 0; i < 8; i++) {
            if ((crc & 0x8000) !== 0) {
                crc = (crc << 1) ^ 0x1021;
            } else {
                crc <<= 1;
            }
            crc &= 0xFFFF;
        }
    }
    return crc.toString(16).toUpperCase().padStart(4, '0');
}
</script>

</body>
</html>